#!/usr/bin/env bash

# --- SCRIPT SIGNATURE --- #
#
#
#                                                                          ██
#   ▄████▄   ██▄████▄  ██▄  ▄██             ▄███▄██   ▄████▄   ██    ██  ███████    ▄████▄   ▄▄█████▄
#  ██▄▄▄▄██  ██▀   ██   ██  ██             ██▀  ▀██  ██▀  ▀██  ██    ██    ██      ██▄▄▄▄██  ██▄▄▄▄ ▀
#  ██▀▀▀▀▀▀  ██    ██   ▀█▄▄█▀    █████    ██    ██  ██    ██  ██    ██    ██      ██▀▀▀▀▀▀   ▀▀▀▀██▄
#  ▀██▄▄▄▄█  ██    ██    ████              ▀██▄▄███  ▀██▄▄██▀  ██▄▄▄███    ██▄▄▄   ▀██▄▄▄▄█  █▄▄▄▄▄██
#    ▀▀▀▀▀   ▀▀    ▀▀     ▀▀                 ▀▀▀ ██    ▀▀▀▀     ▀▀▀▀ ▀▀     ▀▀▀▀     ▀▀▀▀▀    ▀▀▀▀▀▀
#                                                ██
#
# --- DESCRIPTION --- #
# Wraps all values inside a .env file with double qoutes for clarity
# --- DEPENDENCIES --- #
# - awk
# - sponge (moreutils)
# --- END SIGNATURE --- #

set -eo pipefail

trap 'exit 1' SIGUSR1

eval "$(include "check-deps")"
checkDeps "$0"
# ---  Main script logic --- #
file="$1"

awk -F= '{
  if ($2 ~ /"/ || NF == 0) {
    print $0
  } else {
    OFS=""; print $1, "="", $2, """
  }
}' "${file}" | sponge "${file}"
